<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>torukagi - JACKPOT MODE</title>
<style>
body { margin:0; overflow:hidden; background:#000511; font-family:Consolas, monospace; color:white; }
.bg-container {
    position:fixed; top:-10%; left:-10%; width:120%; height:120%;
    background:#000511 url('sky.png') no-repeat center center;
    background-size:cover; z-index:-1; transition:transform .1s ease-out, filter .2s;
}
#flash { position:fixed; inset:0; background:white; opacity:0; pointer-events:none; z-index:50; }
canvas { position:fixed; inset:0; z-index:10; pointer-events:none; }

.ui { position:fixed; bottom:30px; left:30px; z-index:100; }
.btn { cursor:pointer; padding:10px 20px; border:1px solid white; background:rgba(0,0,0,.6); border-radius:5px; }

#clock { font-size:36px; font-weight:bold; text-shadow:0 0 10px #00f2ff; margin-top:10px; }

.jackpot {
    position:fixed; inset:0; display:flex; justify-content:center; align-items:center;
    font-size:140px; font-weight:bold;
    color:gold;
    text-shadow:0 0 20px red, 0 0 40px yellow, 0 0 80px white;
    opacity:0; pointer-events:none; z-index:60;
    transform:scale(0.5);
}

@keyframes shake {
    0%{transform:translate(0,0)}
    25%{transform:translate(-10px,5px)}
    50%{transform:translate(10px,-5px)}
    75%{transform:translate(-5px,10px)}
    100%{transform:translate(0,0)}
}
.shake { animation:shake .3s linear infinite; }
</style>
</head>
<body>

<div class="bg-container" id="bg"></div>
<div id="flash"></div>
<canvas id="cvs"></canvas>
<div class="jackpot" id="jackpot">Â§ßÂΩì„Åü„Çä</div>

<div class="ui">
    <div id="mute-btn" class="btn">üîä SOUND: TAP TO START</div>
    <div id="clock"></div>
</div>

<script>
const bg = document.getElementById('bg');
const flash = document.getElementById('flash');
const cvs = document.getElementById('cvs');
const ctx = cvs.getContext('2d');
const clockEl = document.getElementById('clock');
const muteBtn = document.getElementById('mute-btn');
const jackpot = document.getElementById('jackpot');

let w,h,particles=[],lasers=[],isMuted=false,started=false;

const hype = new Audio('hype.mp3');
hype.loop = true;
hype.volume = 0.7;

function resize(){ w=cvs.width=innerWidth; h=cvs.height=innerHeight; }
addEventListener('resize', resize); resize();

function updateClock(){
    clockEl.textContent = new Date().toLocaleTimeString('ja-JP',{hour12:false});
}
setInterval(updateClock,1000); updateClock();

function startAudio(){
    if(started) return;
    started = true;
    hype.play().catch(()=>{});
    muteBtn.textContent = "üîä SOUND: ON";
}

muteBtn.onclick=()=>{
    startAudio();
    isMuted=!isMuted;
    hype.volume=isMuted?0:0.7;
    muteBtn.textContent=isMuted?"üîá SOUND: OFF":"üîä SOUND: ON";
};

document.addEventListener("click", startAudio, {once:true});

class Particle{
    constructor(){this.init();}
    init(){
        this.x=Math.random()*w; this.y=Math.random()*h;
        this.vx=(Math.random()-0.5)*10; this.vy=(Math.random()-0.5)*10;
        this.life=Math.random()*50+30;
        this.size=Math.random()*4+1;
        this.hue=Math.random()*360;
    }
    update(){ this.x+=this.vx; this.y+=this.vy; if(--this.life<=0) this.init(); }
    draw(){
        ctx.beginPath();
        ctx.fillStyle=`hsla(${this.hue},100%,60%,.9)`;
        ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
        ctx.fill();
    }
}

class Laser{
    constructor(){this.init();}
    init(){
        this.x=Math.random()*w;
        this.y=Math.random()*h*0.6;
        this.len=Math.random()*150+80;
        this.speed=Math.random()*20+25;
        this.hue=Math.random()*360;
    }
    update(){ this.x-=this.speed; this.y+=this.speed*0.5; if(this.x<-200||this.y>h+200) this.init(); }
    draw(){
        const g=ctx.createLinearGradient(this.x,this.y,this.x+this.len,this.y-this.len*0.4);
        g.addColorStop(0,`hsla(${this.hue},100%,70%,1)`);
        g.addColorStop(1,"rgba(255,255,255,0)");
        ctx.strokeStyle=g; ctx.lineWidth=4;
        ctx.beginPath(); ctx.moveTo(this.x,this.y);
        ctx.lineTo(this.x+this.len,this.y-this.len*0.4);
        ctx.stroke();
    }
}

for(let i=0;i<400;i++) particles.push(new Particle());
for(let i=0;i<5;i++) lasers.push(new Laser());

function triggerJackpot(){
    jackpot.style.opacity=1;
    jackpot.style.transform="scale(1.2)";
    document.body.classList.add("shake");

    for(let i=0;i<8;i++){
        setTimeout(()=>{
            flash.style.background=`hsl(${Math.random()*360},100%,70%)`;
            flash.style.opacity=0.8;
            setTimeout(()=>flash.style.opacity=0,80);
        }, i*120);
    }

    setTimeout(()=>{
        jackpot.style.opacity=0;
        jackpot.style.transform="scale(0.5)";
        document.body.classList.remove("shake");
    },1200);
}

function animate(){
    ctx.clearRect(0,0,w,h);

    particles.forEach(p=>{p.update();p.draw();});
    lasers.forEach(l=>{l.update();l.draw();});

    if(Math.random()>0.992) triggerJackpot();

    const pulse=Math.sin(Date.now()*0.006)*6;
    bg.style.filter=`brightness(${1+pulse*0.03}) saturate(1.8)`;

    requestAnimationFrame(animate);
}
animate();

document.addEventListener('mousemove',e=>{
    const x=(w/2-e.clientX)/25;
    const y=(h/2-e.clientY)/25;
    bg.style.transform=`translate(${x}px,${y}px)`;
});
</script>
</body>
</html>
